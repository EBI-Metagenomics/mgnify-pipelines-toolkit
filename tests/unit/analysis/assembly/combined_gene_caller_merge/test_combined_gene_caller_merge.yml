- name: Combined Gene Caller merge test (out input, masking)
  # This is for the pre-pyrodigal version, we changed the parameters for this
  tags:
    - combined_gen_caller_merge
  command: >
    python
    -m mgnify_pipelines_toolkit.analysis.assembly.combined_gene_caller_merge
    -n prodigal_fgs
    --pyrodigal-out tests/fixtures/combined_gene_caller_merge/input_prodigal.out
    --pyrodigal-ffn tests/fixtures/combined_gene_caller_merge/input_prodigal.ffn
    --pyrodigal-faa tests/fixtures/combined_gene_caller_merge/input_prodigal.faa
    --fgsrs-out tests/fixtures/combined_gene_caller_merge/input_fgs.out
    --fgsrs-ffn tests/fixtures/combined_gene_caller_merge/input_fgs.ffn
    --fgsrs-faa tests/fixtures/combined_gene_caller_merge/input_fgs.faa
    --mask tests/fixtures/combined_gene_caller_merge/cmsearch.all.tblout.deoverlapped
    -v
  files:
    - path: "prodigal_fgs.faa"
      md5sum: 3016fc84a3aa760d3eab1dfc5d320e6c
    - path: "prodigal_fgs.ffn"
      md5sum: b40145886c1c12d7f45e9d8134961b88
    - path: "prodigal_fgs.gff"
      md5sum: 7c1fb12df60be84ba071640003fac7e5

- name: Combined Gene Caller merge test (gff input, no masking)
  tags:
    - combined_gen_caller_merge
  command: >
    python
    -m mgnify_pipelines_toolkit.analysis.assembly.combined_gene_caller_merge
    -n pyrodigal_fgsrs
    --pyrodigal-gff tests/fixtures/combined_gene_caller_merge/input_pyrodigal.gff
    --pyrodigal-ffn tests/fixtures/combined_gene_caller_merge/input_pyrodigal.ffn
    --pyrodigal-faa tests/fixtures/combined_gene_caller_merge/input_pyrodigal.faa
    --fgsrs-gff tests/fixtures/combined_gene_caller_merge/input_fgsrs.gff
    --fgsrs-ffn tests/fixtures/combined_gene_caller_merge/input_fgsrs.ffn
    --fgsrs-faa tests/fixtures/combined_gene_caller_merge/input_fgsrs.faa
    -v
  files:
    - path: "pyrodigal_fgsrs.faa"
      md5sum: 06161453ab0bcfa75285c2b4cdcaf5d4
    - path: "pyrodigal_fgsrs.ffn"
      md5sum: b02b98154ab052350adad8b21d9fd074
    - path: "pyrodigal_fgsrs.gff"
      md5sum: 774a5966f0cef53d3b17d4b5f432128e

# TODO: we need to run and validate this
# - name: fraggenescan_prodigal_with_masking
#   command: python combined_gene_caller/cli.py -n fgs_prodigal --prodigal-out tests/test_data/input_prodigal.out --prodigal-ffn tests/test_data/input_prodigal.ffn --prodigal-faa tests/test_data/input_prodigal.faa --fgs-out tests/test_data/input_fgs.out --fgs-ffn tests/test_data/input_fgs.ffn --fgs-faa tests/test_data/input_fgs.faa --mask tests/test_data/cmsearch.all.tblout.deoverlapped --caller-priority fgs_prodigal -vvv
#   files:
#     - path: "fgs_prodigal.faa"
#       md5sum: 4af531ceb8d697a2f5d7c98f6d161291
#     - path: "fgs_prodigal.ffn"
#       md5sum: a48b72cbc3ce184aee06df12d1387a7e
