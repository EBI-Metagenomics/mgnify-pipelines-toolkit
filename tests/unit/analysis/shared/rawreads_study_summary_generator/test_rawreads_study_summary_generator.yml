- name: rawreads_study_summary_generator test_wrong_args
  tags:
    - rawreads_study_summary_generator
  exit_code: 2
  command: rawreads_study_summary_generator --chromosome X
  stderr:
    contains:
      - "Error: No such option: --chromosome"

- name: rawreads_study_summary_generator test_summarise_multi_insdc
  tags:
    - rawreads_study_summary_generator
  command: rawreads_study_summary_generator summarise -a tests/fixtures/study_summary_inputs/rawreads -r tests/fixtures/study_summary_inputs/rawreads/qc_passed.csv -p chunk1
  files:
    - path: "chunk1_motus_study_summary.tsv"
      md5sum: 6f1ca89fc99165ec1e257615a9d0149c
    - path: "chunk1_silva-ssu_study_summary.tsv"
      md5sum: 35ed67129c366e41d8f37fb6185fd47b
    - path: "chunk1_silva-lsu_study_summary.tsv"
      md5sum: 963c7d7897277a203efff6d07e12cd8d
    - path: "chunk1_pfam_read-count_study_summary.tsv"
      md5sum: 3870a3c69fee3a4733aa259c1c34dfa3
    - path: "chunk1_pfam_coverage-depth_study_summary.tsv"
      md5sum: fc2a163a5dda5bc4c05a7f4716e31b49
    - path: "chunk1_pfam_coverage-breadth_study_summary.tsv"
      md5sum: efc1be4b2a033620ab94463cf7601f85

- name: rawreads_study_summary_generator test_insdc_error
  tags:
    - rawreads_study_summary_generator
  command: rawreads_study_summary_generator summarise -a tests/fixtures/study_summary_inputs/rawreads -r tests/fixtures/study_summary_inputs/rawreads/qc_passed_noninsdc.csv -p chunk2
  exit_code: 1
  stderr:
    contains:
      - "{'run': 'dummy-ERR10889056'}"
      - "{'run': 'dummy-ERR10889147'}"

- name: rawreads_study_summary_generator test_summarise_multi_noninsdc
  tags:
    - rawreads_study_summary_generator
  command: rawreads_study_summary_generator summarise -a tests/fixtures/study_summary_inputs/rawreads -r tests/fixtures/study_summary_inputs/rawreads/qc_passed_noninsdc.csv -p chunk2 --non_insdc
  files:
    - path: "chunk2_motus_study_summary.tsv"
      md5sum: 7f63df693e79c0f731832f01144e1cca
    - path: "chunk2_silva-ssu_study_summary.tsv"
      md5sum: 3c245667c4dd4995736e1ca8bf382d84
    - path: "chunk2_silva-lsu_study_summary.tsv"
      md5sum: ae0d346a76c06b7d244ef0e1c316a055
    - path: "chunk2_pfam_read-count_study_summary.tsv"
      md5sum: 60f5b7c87862e1c9a32e677d42c8d563
    - path: "chunk2_pfam_coverage-depth_study_summary.tsv"
      md5sum: 86d6f80590a59ac2421b1d224066c3e6
    - path: "chunk2_pfam_coverage-breadth_study_summary.tsv"
      md5sum: 47575e501751c43c3480a89ae623811b

- name: rawreads_study_summary_generator test_invalid_success_status
  tags:
    - rawreads_study_summary_generator
  exit_code: 1
  command: rawreads_study_summary_generator summarise -a tests/fixtures/study_summary_inputs/rawreads -r tests/fixtures/study_summary_inputs/rawreads/qc_passed_invalid_status.csv -p chunk1 --non_insdc
  stderr:
    contains:
      - "{'status': 'all_resultsssss'}"

- name: rawreads_study_summary_generator test_invalid_taxonomic_ranks
  tags:
    - rawreads_study_summary_generator
  exit_code: 1
  command: rawreads_study_summary_generator summarise -a tests/fixtures/study_summary_inputs/rawreads -r tests/fixtures/study_summary_inputs/rawreads/qc_passed_invalid_taxranks.csv -p chunk1 --non_insdc
  stderr:
    contains:
      - "{'Kingdom': 'kkkk__Bacteria'"

- name: rawreads_study_summary_generator test_correct_args_merge
  tags:
    - rawreads_study_summary_generator
  command: rawreads_study_summary_generator merge -a tests/fixtures/study_summary_inputs/rawreads -p merged
  files:
    - path: "merged_motus_study_summary.tsv"
      md5sum: e98ccf63ead47882a3489da3180ca19c
    - path: "merged_silva-ssu_study_summary.tsv"
      md5sum: 21ec281ffd9ece28f9810d8cd4130f97
    - path: "merged_silva-lsu_study_summary.tsv"
      md5sum: 2867228e86e41c1750dcb029c5738492
    - path: "merged_pfam_read-count_study_summary.tsv"
      md5sum: b759b2f4367946fe2f86c850e26abd6a
    - path: "merged_pfam_coverage-depth_study_summary.tsv"
      md5sum: 6bd913bbe3dcc178af6aaeb965febb06
    - path: "merged_pfam_coverage-breadth_study_summary.tsv"
      md5sum: eb60d28614750738df184e006cf86e90
